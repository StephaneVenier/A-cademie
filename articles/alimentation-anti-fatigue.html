<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>A-Cad√©mie ‚Äî Alimentation anti-fatigue : quoi manger ?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/acad-style.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="../js/firebase-config.js"></script>
</head>

<body>
  <div class="page">

    <!-- HEADER -->
    <header class="acad-header">
      <a href="../index.html" class="brand" style="text-decoration:none;">
        <div class="brand-logo">A</div>
        <div>
          <div class="brand-text-title">A-Cad√©mie</div>
          <div class="brand-text-sub">Nutrition & √ânergie ‚Äî Version 2025</div>
        </div>
      </a>

      <nav class="acad-nav">
        <a class="nav-btn" href="../index.html"><span class="dot"></span> Accueil</a>
        <a class="nav-btn primary" href="../articles.html">Articles</a>
        <a class="nav-btn" href="../recompenses.html">R√©compenses</a>
      </nav>

      <div id="acad-profile" class="profile-card">
        <div class="profile-main">
          <div class="profile-avatar">‚ö°</div>
          <div>
            <div class="profile-level">Niveau <span id="acad-level">1</span></div>
            <div class="profile-xp"><span id="acad-xp">0</span> XP locale</div>
          </div>
        </div>
        <div class="profile-progress-wrapper">
          <div class="profile-progress-bar"><div class="profile-progress-fill" id="acad-xp-bar"></div></div>
          <div class="profile-progress-label">
            <span>Vers niveau <span id="acad-next-level">2</span></span>
            <span id="acad-xp-to-next">0 / 100</span>
          </div>
        </div>
      </div>
    </header>

    <main class="layout">

      <!-- ARTICLE -->
      <article class="article-card">
        <div class="article-meta">
          <span class="tag"><span class="tag-dot"></span> Nutrition & √ânergie</span>
          <span class="chip">Lecture : 6 min</span>
          <span class="chip">Niveau : D√©butant</span>
        </div>

        <h1 class="article-title">Alimentation anti-fatigue : quoi manger ?</h1>
        <p class="article-subtitle">
          ‚ÄúJe suis fatigu√© tout le temps‚Ä¶‚Äù  
          L‚Äôalimentation joue un r√¥le √©norme dans l‚Äô√©nergie quotidienne. Certains aliments dopent ton √©nergie, d‚Äôautres
          la volent. Voici une m√©thode simple pour manger ‚Äúanti-fatigue‚Äù.
        </p>

        <div class="article-highlight">
          <strong>√Ä retenir :</strong> l‚Äô√©nergie vient surtout de la stabilit√© (glyc√©mie, hydratation, nutriments cl√©s),
          pas du sucre rapide ni du caf√© √† r√©p√©tition.
        </div>

        <div class="article-content">

          <h2>1Ô∏è‚É£ Stabiliser la glyc√©mie : la base anti-fatigue</h2>
          <p>
            Les montagnes russes de sucre entra√Ænent : coups de barre, irritabilit√©, fringales.
            Pour √©viter √ßa :
          </p>
          <ul>
            <li>Privil√©gie les aliments complets (avoine, riz complet, l√©gumineuses)</li>
            <li>Mange des prot√©ines √† chaque repas</li>
            <li>√âvite les sucres rapides isol√©s (viennoiseries, sodas, biscuits)</li>
          </ul>

          <h2>2Ô∏è‚É£ Faire le plein de fer, magn√©sium et om√©ga 3</h2>
          <p>Ces nutriments interviennent directement dans l‚Äô√©nergie et la concentration.</p>
          <ul>
            <li><strong>Fer :</strong> lentilles, boudin noir, viande rouge, tofu, √©pinards</li>
            <li><strong>Magn√©sium :</strong> amandes, cacao noir, banane, eau min√©rale riche en magn√©sium</li>
            <li><strong>Om√©ga 3 :</strong> sardines, maquereau, noix, graines de chia</li>
          </ul>

          <h2>3Ô∏è‚É£ Boire suffisamment</h2>
          <p>
            80% des gens pensent √™tre fatigu√©s‚Ä¶ alors qu‚Äôils sont d√©shydrat√©s.  
            Avant de chercher une solution complexe : bois un verre d‚Äôeau.
          </p>

          <h2>4Ô∏è‚É£ La r√®gle des 3 √©l√©ments par repas</h2>
          <p>Pour une √©nergie stable :</p>
          <ul>
            <li><strong>Prot√©ine</strong> (≈ìuf, poisson, tofu, poulet‚Ä¶)</li>
            <li><strong>L√©gumes</strong> (frais, surgel√©s ou crudit√©s)</li>
            <li><strong>F√©culents complets</strong> (p√¢tes compl√®tes, riz complet, lentilles‚Ä¶)</li>
          </ul>

          <h2>5Ô∏è‚É£ Les aliments qui donnent de l‚Äô√©nergie durable</h2>
          <ul>
            <li>Flocons d‚Äôavoine + fruits + graines</li>
            <li>Yaourt nature + noix + miel</li>
            <li>Banane + beurre d‚Äôamande</li>
            <li>Bowl : riz complet + l√©gumes + thon + huile d‚Äôolive</li>
            <li>Soupe + tartine compl√®te + ≈ìuf dur</li>
          </ul>

          <h2>6Ô∏è‚É£ Les aliments qui volent ton √©nergie</h2>
          <ul>
            <li>Sodas et boissons sucr√©es ‚Üí pic de sucre ‚Üí crash</li>
            <li>Viennoiseries ‚Üí 2h apr√®s, grosse fatigue</li>
            <li>Alcool ‚Üí sommeil de mauvaise qualit√© ‚Üí fatigue le lendemain</li>
            <li>Snacking ultra transform√©</li>
          </ul>

          <h2>7Ô∏è‚É£ Exemple de journ√©e anti-fatigue</h2>
          <ul>
            <li><strong>Petit-d√©jeuner :</strong> avoine + banane + noix</li>
            <li><strong>D√©jeuner :</strong> bowl complet (poulet + l√©gumes + riz complet)</li>
            <li><strong>Snack :</strong> fruit + ol√©agineux</li>
            <li><strong>D√Æner :</strong> soupe + f√©culent complet + ≈ìuf ou poisson</li>
          </ul>

        </div>

        <div class="article-footer-note">
          <span class="bullet-pill">üéÆ Gamification locale</span>
          <span>Lecture & quiz = XP gagn√©e sur cet appareil.</span>
        </div>

        <button type="button" class="btn btn-secondary" id="mark-article-read">‚úì J‚Äôai lu cet article (gagner de l‚ÄôXP)</button>

        <div style="margin-top:12px;">
          <button type="button" class="btn btn-primary" id="share-article">
            üîó Partager cet article / quiz
          </button>
          <div id="share-feedback" style="font-size:12px;color:var(--text-soft);margin-top:4px;"></div>
        </div>

      </article>

      <!-- QUIZ -->
      <section class="quiz-card" id="quiz-section">
        <div class="quiz-header">
          <div class="quiz-left">
            <div class="quiz-title">Quiz express : Alimentation anti-fatigue</div>
            <div class="quiz-caption">5 questions pour valider les bases de l'√©nergie durable.</div>
          </div>
          <div class="quiz-badge">‚ö° 5 questions ¬∑ 3 min</div>
        </div>

        <div class="quiz-progress" id="quiz-progress">Question 1 sur 5</div>
        <form id="quiz-form"></form>

        <div class="quiz-footer">
          <div class="quiz-actions">
            <button type="button" class="btn btn-primary" id="quiz-submit">Valider mes r√©ponses</button>
            <button type="button" class="btn btn-secondary" id="quiz-reset">Recommencer</button>
          </div>
          <div class="quiz-result" id="quiz-result">R√©ponds puis valide pour voir ton score.</div>
        </div>

        <div class="quiz-feedback" id="quiz-feedback"></div>
      </section>
    </main>
  </div>

  <!-- SCRIPTS GAMIFICATION -->
  <script src="../js/acad-gamification.js"></script>
  <script src="../js/acad-firebase-sync.js"></script>

  <script>
    const ARTICLE_ID = "alimentation-anti-fatigue";

    const quizData = [
      {
        id: 1,
        question: "Qu‚Äôest-ce qui cause souvent les ‚Äúcoups de barre‚Äù ?",
        options: [
          "Manger des l√©gumes",
          "Les variations rapides de sucre dans le sang",
          "Boire trop d‚Äôeau",
          "Manger des prot√©ines"
        ],
        correctIndex: 1
      },
      {
        id: 2,
        question: "Quel nutriment aide √† r√©duire la fatigue ?",
        options: [
          "Fer",
          "Colorants alimentaires",
          "Glucose pur",
          "Beurre"
        ],
        correctIndex: 0
      },
      {
        id: 3,
        question: "Quel est un bon exemple de snack anti-fatigue ?",
        options: [
          "Chips + soda",
          "Fruit + ol√©agineux",
          "Viennoiserie",
          "Bonbons"
        ],
        correctIndex: 1
      },
      {
        id: 4,
        question: "Quel aliment vole ton √©nergie ?",
        options: [
          "Riz complet",
          "Soupe maison",
          "Sodas sucr√©s",
          "≈íufs"
        ],
        correctIndex: 2
      },
      {
        id: 5,
        question: "Quel trio compose un repas anti-fatigue id√©al ?",
        options: [
          "Dessert + jus + pain blanc",
          "Prot√©ines + l√©gumes + f√©culents complets",
          "Viennoiserie + caf√© sucr√©",
          "Sauce + viande + soda"
        ],
        correctIndex: 1
      }
    ];

    const quizForm = document.getElementById("quiz-form");
    const quizProgress = document.getElementById("quiz-progress");
    const quizResult = document.getElementById("quiz-result");
    const quizFeedback = document.getElementById("quiz-feedback");
    const submitBtn = document.getElementById("quiz-submit");
    const resetBtn = document.getElementById("quiz-reset");

    function renderQuiz() {
      quizForm.innerHTML = "";
      quizData.forEach((q, index) => {
        const div = document.createElement("div");
        div.className = "quiz-question";
        div.dataset.questionId = q.id;

        div.innerHTML = `
          <div class="quiz-question-header">
            <div class="quiz-question-label">Q${index + 1}. ${q.question}</div>
            <div class="quiz-question-meta">1 seule bonne r√©ponse</div>
          </div>
          <div class="quiz-options">
            ${q.options.map((opt, i) => `
              <label class="quiz-option">
                <input type="radio" name="question-${q.id}" value="${i}">
                <span>${opt}</span>
              </label>`).join("")}
          </div>
        `;
        quizForm.appendChild(div);
      });

      quizProgress.textContent = "Question 1 sur " + quizData.length;
      quizResult.textContent = "R√©ponds puis valide pour voir ton score.";
      quizFeedback.textContent = "";
    }

    function updateProgress() {
      const total = quizData.length;
      const answered = quizData.filter(q =>
        Array.from(document.querySelectorAll(`input[name="question-${q.id}"]`)).some(r => r.checked)
      ).length;
      quizProgress.textContent = "Question " + (answered || 1) + " sur " + total;
    }
    quizForm.addEventListener("change", updateProgress);

    function evaluateQuiz() {
      let score = 0;

      document.querySelectorAll(".quiz-option").forEach(o =>
        o.classList.remove("correct","incorrect")
      );

      quizData.forEach(q => {
        const radios = document.querySelectorAll(`input[name="question-${q.id}"]`);
        let sel = null;
        radios.forEach((r, idx) => { if (r.checked) sel = idx; });

        const block = document.querySelector(`.quiz-question[data-question-id="${q.id}"]`);
        const opts = block.querySelectorAll(".quiz-option");

        if (sel === q.correctIndex) {
          score++;
          opts[sel]?.classList.add("correct");
        } else {
          opts[q.correctIndex]?.classList.add("correct");
          if (sel !== null) opts[sel]?.classList.add("incorrect");
        }
      });

      const ratio = score / quizData.length;
      let msg =
        ratio === 1 ? "Parfait ! Tu ma√Ætrises les fondamentaux de l‚Äôalimentation anti-fatigue ‚ö°" :
        ratio >= 0.7 ? "Tr√®s bon score !" :
        ratio >= 0.4 ? "Pas mal, relis certains points." :
        "C‚Äôest un d√©but : relis l‚Äôarticle tranquillement.";

      quizResult.innerHTML = `<strong>${score}/${quizData.length}</strong> bonnes r√©ponses ‚Ä¢ ${msg}`;

      if (window.acadGamification) {
        window.acadGamification.registerQuizResult(ARTICLE_ID, score, quizData.length);
      }

      quizFeedback.textContent =
        ratio === 1 ? "üéÆ Bravo ! XP bonus ajout√©e." : "Tu peux recommencer pour viser le 100 %.";
    }

    submitBtn.addEventListener("click", evaluateQuiz);
    resetBtn.addEventListener("click", renderQuiz);

    // Lecture =
    const readBtn = document.getElementById("mark-article-read");
    if (readBtn) {
      readBtn.addEventListener("click", () => {
        if (window.acadGamification)
          window.acadGamification.markArticleRead(ARTICLE_ID, 20);
        readBtn.textContent = "‚úì Article compt√© pour l‚ÄôXP locale";
        readBtn.disabled = true;
      });
    }

    // Partage
    const shareBtn = document.getElementById("share-article");
    const shareFeedback = document.getElementById("share-feedback");
    if (shareBtn) {
      shareBtn.addEventListener("click", async () => {
        if (window.acadGamification)
          window.acadGamification.registerShare(ARTICLE_ID, 15);

        const shareData = {
          title: "A-Cad√©mie ‚Äî Alimentation anti-fatigue",
          text: "D√©couvre quoi manger pour avoir plus d‚Äô√©nergie + un quiz express !",
          url: window.location.href
        };

        if (navigator.share) {
          try { await navigator.share(shareData);
            shareFeedback.textContent = "Merci pour le partage ! (XP ajout√©e)";
          } catch (e) {
            shareFeedback.textContent = "Partage annul√© üòâ";
          }
        } else {
          shareFeedback.textContent = "Le partage automatique n‚Äôest pas dispo, mais tu peux copier l‚Äôadresse.";
        }
      });
    }

    renderQuiz();
  </script>

</body>
</html>
