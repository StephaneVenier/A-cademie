<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>A-CadÃ©mie â€” Routine bien-Ãªtre du matin (5 minutes)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/acad-style.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="../js/firebase-config.js"></script>
</head>

<body>
  <div class="page">

    <!-- HEADER IDENTIQUE AUX AUTRES ARTICLES -->
    <header class="acad-header">
      <a href="../index.html" class="brand" style="text-decoration:none;">
        <div class="brand-logo">A</div>
        <div>
          <div class="brand-text-title">A-CadÃ©mie</div>
          <div class="brand-text-sub">Routine & Bien-Ãªtre â€” Gratuit & accessible</div>
        </div>
      </a>

      <nav class="acad-nav">
        <a class="nav-btn" href="../index.html"><span class="dot"></span> Accueil</a>
        <a class="nav-btn primary" href="../articles.html">Articles</a>
        <a class="nav-btn" href="../recompenses.html">RÃ©compenses</a>
      </nav>

      <div id="acad-profile" class="profile-card">
        <div class="profile-main">
          <div class="profile-avatar">ğŸŒ</div>
          <div>
            <div class="profile-level">Niveau <span id="acad-level">1</span></div>
            <div class="profile-xp"><span id="acad-xp">0</span> XP locale</div>
          </div>
        </div>
        <div class="profile-progress-wrapper">
          <div class="profile-progress-bar">
            <div class="profile-progress-fill" id="acad-xp-bar"></div>
          </div>
          <div class="profile-progress-label">
            <span>Vers niveau <span id="acad-next-level">2</span></span>
            <span id="acad-xp-to-next">0 / 100</span>
          </div>
        </div>
      </div>
    </header>

    <main class="layout">

      <!-- ARTICLE -->
      <article class="article-card">
        <div class="article-meta">
          <span class="tag"><span class="tag-dot"></span> Bien-Ãªtre & HygiÃ¨ne de vie</span>
          <span class="chip">Lecture : 4 min</span>
          <span class="chip">Niveau : DÃ©butant</span>
        </div>

        <h1 class="article-title">Routine bien-Ãªtre du matin (5 minutes)</h1>
        <p class="article-subtitle">
          Une routine ultra simple pour commencer la journÃ©e avec plus dâ€™Ã©nergie, moins de stress et un mental clair.
        </p>

        <div class="article-highlight">
          <strong>Ã€ retenir :</strong> 5 minutes suffisent pour changer lâ€™ambiance de ta journÃ©e. Le secret : simplicitÃ© + rÃ©gularitÃ©.
        </div>

        <div class="article-content">

          <h2>1ï¸âƒ£ 30 secondes â€” un grand verre dâ€™eau</h2>
          <p>Tu tâ€™es dÃ©shydratÃ© pendant la nuit. Un verre dâ€™eau au rÃ©veil relance digestion, concentration et Ã©nergie.</p>

          <h2>2ï¸âƒ£ 1 minute â€” respiration lente</h2>
          <p>4 secondes inspire â†’ 6 secondes expire.  
             IdÃ©al pour rÃ©duire la tension matinale et activer ton systÃ¨me nerveux â€œcalmeâ€.</p>

          <h2>3ï¸âƒ£ 1 minute â€” mobilitÃ©s douces</h2>
          <ul>
            <li>Cercle des Ã©paules</li>
            <li>Rotation du cou</li>
            <li>Ouverture de la cage thoracique</li>
          </ul>
          <p>Juste de quoi dÃ©rouiller les articulations.</p>

          <h2>4ï¸âƒ£ 1 minute â€” Ã©tirement dos + hanches</h2>
          <p>Position â€œchien tÃªte en basâ€, ou simplement Ã©tirement des hanches + bas du dos.  
             Ã‡a rÃ©duit les raideurs et amÃ©liore la posture pour la journÃ©e.</p>

          <h2>5ï¸âƒ£ 1 minute â€” mini objectif mental</h2>
          <p>
            Juste une phrase :  
            <strong>â€œQuâ€™est-ce qui ferait de cette journÃ©e une bonne journÃ©e ?â€</strong><br>
            (une action simple, pas un exploit)
          </p>

        </div>

        <div class="article-footer-note">
          <span class="bullet-pill">ğŸ® Gamification locale</span>
          <span>Lecture + quiz + partage = XP gagnÃ©e automatiquement.</span>
        </div>

        <button type="button" class="btn btn-secondary" id="mark-article-read">âœ“ Jâ€™ai lu cet article (gagner de lâ€™XP)</button>

        <div style="margin-top:12px;">
          <button type="button" class="btn btn-primary" id="share-article">ğŸ”— Partager cet article / quiz</button>
          <div id="share-feedback" style="font-size:12px;color:var(--text-soft);margin-top:4px;"></div>
        </div>

      </article>


      <!-- QUIZ -->
      <section class="quiz-card" id="quiz-section">

        <div class="quiz-header">
          <div class="quiz-left">
            <div class="quiz-title">Quiz express : Routine du matin</div>
            <div class="quiz-caption">5 questions rapides pour valider les bonnes habitudes du matin.</div>
          </div>
          <div class="quiz-badge">âš¡ 5 questions Â· 2 min</div>
        </div>

        <div class="quiz-progress" id="quiz-progress">Question 1 sur 5</div>
        <form id="quiz-form"></form>

        <div class="quiz-footer">
          <div class="quiz-actions">
            <button type="button" class="btn btn-primary" id="quiz-submit">Valider mes rÃ©ponses</button>
            <button type="button" class="btn btn-secondary" id="quiz-reset">Recommencer</button>
          </div>
          <div class="quiz-result" id="quiz-result">RÃ©ponds aux questions puis valide pour voir ton score.</div>
        </div>

        <div class="quiz-feedback" id="quiz-feedback"></div>

      </section>

    </main>
  </div>

  <!-- SCRIPTS GAMIFICATION -->
  <script src="../js/acad-gamification.js"></script>
  <script src="../js/acad-firebase-sync.js"></script>

  <script>
    const ARTICLE_ID = "routine-bien-etre-matin";

    const quizData = [
      {
        id: 1,
        question: "Quelle est la premiÃ¨re Ã©tape de la routine ?",
        options: [
          "Faire son lit",
          "Prendre un grand verre dâ€™eau",
          "Faire 20 pompes",
          "Regarder son tÃ©lÃ©phone"
        ],
        correctIndex: 1
      },
      {
        id: 2,
        question: "Pourquoi respirer lentement 1 minute ?",
        options: [
          "Pour augmenter le stress",
          "Pour activer le systÃ¨me nerveux calme",
          "Pour brÃ»ler des calories",
          "Pour se rendormir"
        ],
        correctIndex: 1
      },
      {
        id: 3,
        question: "La mobilitÃ© du matin sert Ã â€¦",
        options: [
          "Gagner du muscle",
          "Se rÃ©chauffer avant un marathon",
          "DÃ©rouiller les articulations en douceur",
          "Faire un entraÃ®nement complet"
        ],
        correctIndex: 2
      },
      {
        id: 4,
        question: "Quel est lâ€™objectif de la derniÃ¨re Ã©tape ?",
        options: [
          "Se critiquer",
          "Fixer un mini objectif simple pour la journÃ©e",
          "Ã‰crire un roman",
          "Se peser absolument"
        ],
        correctIndex: 1
      },
      {
        id: 5,
        question: "Combien de minutes dure cette routine ?",
        options: [
          "2 minutes",
          "10 minutes",
          "5 minutes",
          "30 minutes"
        ],
        correctIndex: 2
      }
    ];

    // Rendering, scoring, XP (identique aux autres articles)
    const quizForm = document.getElementById("quiz-form");
    const quizProgress = document.getElementById("quiz-progress");
    const quizResult = document.getElementById("quiz-result");
    const quizFeedback = document.getElementById("quiz-feedback");
    const submitBtn = document.getElementById("quiz-submit");
    const resetBtn = document.getElementById("quiz-reset");

    function renderQuiz() {
      quizForm.innerHTML = "";
      quizData.forEach((q, index) => {
        const div = document.createElement("div");
        div.className = "quiz-question";
        div.dataset.questionId = q.id;
        div.innerHTML = `
          <div class="quiz-question-header">
            <div class="quiz-question-label">Q${index + 1}. ${q.question}</div>
            <div class="quiz-question-meta">1 seule bonne rÃ©ponse</div>
          </div>
          <div class="quiz-options">
            ${q.options.map((opt, i) => `
              <label class="quiz-option">
                <input type="radio" name="question-${q.id}" value="${i}">
                <span>${opt}</span>
              </label>
            `).join("")}
          </div>
        `;
        quizForm.appendChild(div);
      });

      quizProgress.textContent = "Question 1 sur " + quizData.length;
      quizFeedback.textContent = "";
      quizResult.textContent = "RÃ©ponds puis valide pour voir ton score.";
    }

    function updateProgress() {
      const total = quizData.length;
      const answered = quizData.filter(q =>
        Array.from(document.querySelectorAll('input[name="question-' + q.id + '"]')).some(r => r.checked)
      ).length;
      quizProgress.textContent = "Question " + (answered === 0 ? 1 : answered) + " sur " + total;
    }
    quizForm.addEventListener("change", updateProgress);

    function evaluateQuiz() {
      let score = 0;
      const total = quizData.length;

      document.querySelectorAll(".quiz-option").forEach(o =>
        o.classList.remove("correct","incorrect")
      );

      quizData.forEach(q => {
        const radios = document.querySelectorAll(`input[name="question-${q.id}"]`);
        let sel = null;
        radios.forEach((r, i) => { if (r.checked) sel = i; });

        const block = document.querySelector(`.quiz-question[data-question-id="${q.id}"]`);
        const opts = block.querySelectorAll(".quiz-option");

        if (sel === q.correctIndex) {
          score++;
          if (opts[sel]) opts[sel].classList.add("correct");
        } else {
          if (opts[q.correctIndex]) opts[q.correctIndex].classList.add("correct");
          if (sel !== null && opts[sel]) opts[sel].classList.add("incorrect");
        }
      });

      const ratio = score / total;
      let msg =
        ratio === 1 ? "Excellent ! Tu maÃ®trises parfaitement cette routine ğŸŒ" :
        ratio >= 0.7 ? "TrÃ¨s bien ! Tu as saisi les bases." :
        ratio >= 0.4 ? "Pas mal, quelques points Ã  revoir." :
        "Relis lâ€™article et retente tranquillement.";

      quizResult.innerHTML = `<strong>${score}/${total}</strong> bonnes rÃ©ponses â€¢ ${msg}`;

      if (window.acadGamification)
        window.acadGamification.registerQuizResult(ARTICLE_ID, score, total);

      quizFeedback.textContent =
        ratio === 1 ? "ğŸ® Bravo ! Quiz parfait, XP bonus enregistrÃ©e." :
        "Tu peux recommencer pour viser le 100 %.";
    }

    submitBtn.addEventListener("click", evaluateQuiz);

    resetBtn.addEventListener("click", () => renderQuiz());

    // Article read
    const readBtn = document.getElementById("mark-article-read");
    if (readBtn) {
      readBtn.addEventListener("click", () => {
        if (window.acadGamification)
          window.acadGamification.markArticleRead(ARTICLE_ID, 20);
        readBtn.textContent = "âœ“ Article comptÃ© pour lâ€™XP locale";
        readBtn.disabled = true;
      });
    }

    // Share
    const shareBtn = document.getElementById("share-article");
    const shareFeedback = document.getElementById("share-feedback");
    if (shareBtn) {
      shareBtn.addEventListener("click", async () => {
        if (window.acadGamification)
          window.acadGamification.registerShare(ARTICLE_ID, 15);

        const shareData = {
          title: "A-CadÃ©mie â€” Routine bien-Ãªtre du matin",
          text: "DÃ©couvre la routine bien-Ãªtre du matin (5 minutes) + quiz express !",
          url: window.location.href
        };

        if (navigator.share) {
          try { await navigator.share(shareData);
            shareFeedback.textContent = "Merci pour le partage ! (XP ajoutÃ©e)";
          } catch (e) {
            shareFeedback.textContent = "Partage annulÃ© ğŸ˜‰";
          }
        } else {
          shareFeedback.textContent = "Le partage automatique nâ€™est pas dispo. Tu peux copier lâ€™adresse.";
        }
      });
    }

    renderQuiz();
  </script>

</body>
</html>
