<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>A-CadÃ©mie â€” Comment arrÃªter le grignotage facilement</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/acad-style.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="../js/firebase-config.js"></script>
</head>

<body>
  <div class="page">

    <!-- HEADER -->
    <header class="acad-header">
      <a href="../index.html" class="brand" style="text-decoration:none;">
        <div class="brand-logo">A</div>
        <div>
          <div class="brand-text-title">A-CadÃ©mie</div>
          <div class="brand-text-sub">Habitudes alimentaires â€” Version 2025</div>
        </div>
      </a>

      <nav class="acad-nav">
        <a class="nav-btn" href="../index.html"><span class="dot"></span> Accueil</a>
        <a class="nav-btn primary" href="../articles.html">Articles</a>
        <a class="nav-btn" href="../recompenses.html">RÃ©compenses</a>
      </nav>

      <div id="acad-profile" class="profile-card">
        <div class="profile-main">
          <div class="profile-avatar">ğŸ</div>
          <div>
            <div class="profile-level">Niveau <span id="acad-level">1</span></div>
            <div class="profile-xp"><span id="acad-xp">0</span> XP locale</div>
          </div>
        </div>

        <div class="profile-progress-wrapper">
          <div class="profile-progress-bar">
            <div class="profile-progress-fill" id="acad-xp-bar"></div>
          </div>
          <div class="profile-progress-label">
            <span>Vers niveau <span id="acad-next-level">2</span></span>
            <span id="acad-xp-to-next">0 / 100</span>
          </div>
        </div>
      </div>
    </header>


    <main class="layout">

      <!-- ARTICLE -->
      <article class="article-card">
        <div class="article-meta">
          <span class="tag"><span class="tag-dot"></span> Nutrition & Habitudes</span>
          <span class="chip">Lecture : 6 min</span>
          <span class="chip">Niveau : DÃ©butant</span>
        </div>

        <h1 class="article-title">Comment arrÃªter le grignotage facilement</h1>
        <p class="article-subtitle">
          Grignoter nâ€™est pas une question de volontÃ© : câ€™est une question dâ€™environnement, dâ€™habitude, dâ€™Ã©motions et de biologie.
          Bonne nouvelle : on peut rÃ©duire le grignotage sans se priver, juste en changeant quelques rÃ©flexes simples.
        </p>

        <div class="article-highlight">
          <strong>Ã€ retenir :</strong> arrÃªter le grignotage ne veut pas dire â€œne plus rien manger entre les repasâ€.  
          Lâ€™objectif : limiter les grignotages automatiques et les remplacer par des choix conscients.
        </div>

        <div class="article-content">

          <h2>1ï¸âƒ£ Comprendre pourquoi tu grignotes</h2>
          <p>Souvent, on grignote pour une raison qui nâ€™a rien Ã  voir avec la faim :</p>
          <ul>
            <li>Stress ou ennui</li>
            <li>Fatigue â†’ envie de sucre</li>
            <li>Habitude (devant une sÃ©rie, au travailâ€¦)</li>
            <li>Repas insuffisants</li>
          </ul>
          <p>
            Avant de â€œcombattreâ€ le grignotage, il faut comprendre dâ€™oÃ¹ il vient.
          </p>

          <h2>2ï¸âƒ£ Faire des vrais repas complets</h2>
          <p>Beaucoup grignotent car leurs repas ne sont pas assez nourrissants.</p>
          <p>Un repas anti-grignotage = <strong>protÃ©ines + lÃ©gumes + fÃ©culents complets + bonnes graisses</strong>.</p>
          <p>
            Quand tu manges Ã©quilibrÃ©, ton corps rÃ©clame moins de sucre et ton Ã©nergie reste stable.
          </p>

          <h2>3ï¸âƒ£ Ranger la nourriture â€œvisibleâ€</h2>
          <p>
            Le cerveau est trÃ¨s sensible aux stimuli visuels :  
            si tu vois des biscuits â†’ tu en veux.  
            Si tu ne les vois pas â†’ tu y penses beaucoup moins.
          </p>
          <p>
            Met simplement les snacks dans un placard haut ou fermÃ©.  
            (Ã‡a change dÃ©jÃ  Ã©normÃ©ment.)
          </p>

          <h2>4ï¸âƒ£ PrÃ©parer des snacks â€œOK Ã  mangerâ€</h2>
          <p>Le but nâ€™est pas de ne rien manger, mais de manger mieux.</p>
          <ul>
            <li>Fruits</li>
            <li>Yaourt nature / fromage blanc</li>
            <li>PoignÃ©e dâ€™amandes ou noix</li>
            <li>Houmous + lÃ©gumes</li>
            <li>Barre aux flocons dâ€™avoine</li>
          </ul>

          <h2>5ï¸âƒ£ Utiliser la rÃ¨gle des 3 questions</h2>
          <p>Avant de grignoter, demande-toi :</p>
          <ol>
            <li>Est-ce que jâ€™ai faim ?</li>
            <li>Est-ce que jâ€™ai soif ? (bois un verre dâ€™eau)</li>
            <li>Est-ce que je suis stressÃ©, fatiguÃ© ou ennuyÃ© ?</li>
          </ol>
          <p>
            Si la faim nâ€™est pas rÃ©elle, tu peux choisir autre chose : marche 2 min, respiration lente, un verre dâ€™eauâ€¦
          </p>

          <h2>6ï¸âƒ£ GÃ©rer le stress autrement que par le sucre</h2>
          <p>
            Le stress pousse Ã  manger sucrÃ©.  
            Remplacer ce rÃ©flexe par un autre rÃ©flexe plus sain :
          </p>
          <ul>
            <li>Respiration lente 1 minute</li>
            <li>Musique calme</li>
            <li>Sortir 2 minutes Ã  lâ€™air frais</li>
          </ul>

          <h2>7ï¸âƒ£ Bonus : Ã©viter lâ€™environnement â€œpiÃ¨geâ€</h2>
          <ul>
            <li>Ne pas travailler Ã  cÃ´tÃ© dâ€™une boÃ®te Ã  biscuits</li>
            <li>Ne pas mettre de snacks devant la TV</li>
            <li>Ne pas faire les courses le ventre vide</li>
          </ul>
          <p>
            Moins tu te mets dans une situation oÃ¹ tu vas craquer,
            plus câ€™est simple de garder le contrÃ´le.
          </p>

        </div>

        <div class="article-footer-note">
          <span class="bullet-pill">ğŸ® Gamification</span>
          <span>Lecture, quiz et partage = XP gagnÃ©e automatiquement.</span>
        </div>

        <button type="button" class="btn btn-secondary" id="mark-article-read">
          âœ“ Jâ€™ai lu cet article (gagner de lâ€™XP)
        </button>

        <div style="margin-top:12px;">
          <button type="button" class="btn btn-primary" id="share-article">
            ğŸ”— Partager cet article / quiz
          </button>
          <div id="share-feedback" style="font-size:12px;margin-top:4px;color:var(--text-soft);"></div>
        </div>

      </article>


      <!-- QUIZ -->
      <section class="quiz-card" id="quiz-section">
        <div class="quiz-header">
          <div class="quiz-left">
            <div class="quiz-title">Quiz express : ArrÃªter le grignotage</div>
            <div class="quiz-caption">5 questions simples pour vÃ©rifier si les bases sont acquises.</div>
          </div>
          <div class="quiz-badge">âš¡ 5 questions Â· 2 min</div>
        </div>

        <div class="quiz-progress" id="quiz-progress">Question 1 sur 5</div>
        <form id="quiz-form"></form>

        <div class="quiz-footer">
          <div class="quiz-actions">
            <button type="button" class="btn btn-primary" id="quiz-submit">Valider mes rÃ©ponses</button>
            <button type="button" class="btn btn-secondary" id="quiz-reset">Recommencer</button>
          </div>
          <div class="quiz-result" id="quiz-result">
            RÃ©ponds puis valide pour voir ton score.
          </div>
        </div>

        <div class="quiz-feedback" id="quiz-feedback"></div>
      </section>

    </main>
  </div>

  <!-- GAMIFICATION -->
  <script src="../js/acad-gamification.js"></script>
  <script src="../js/acad-firebase-sync.js"></script>

  <script>
    const ARTICLE_ID = "arreter-grignotage";

    const quizData = [
      {
        id: 1,
        question: "Quelle est lâ€™une des principales causes du grignotage ?",
        options: [
          "Toujours la faim",
          "Stress, ennui ou fatigue",
          "Boire de lâ€™eau",
          "Manger des lÃ©gumes"
        ],
        correctIndex: 1
      },
      {
        id: 2,
        question: "Quel type de repas aide Ã  Ã©viter de grignoter ?",
        options: [
          "Un repas uniquement sucrÃ©",
          "ProtÃ©ines + lÃ©gumes + fÃ©culents complets",
          "Un repas sans glucides du tout",
          "Un repas trÃ¨s lÃ©ger"
        ],
        correctIndex: 1
      },
      {
        id: 3,
        question: "Quel est un bon exemple de snack Â« ok Â» ?",
        options: [
          "Bonbons",
          "Chips",
          "Amandes ou fruits",
          "Viennoiserie"
        ],
        correctIndex: 2
      },
      {
        id: 4,
        question: "Quelle rÃ¨gle aide Ã  Ã©viter le grignotage automatique ?",
        options: [
          "La rÃ¨gle des 3 questions (faim ? soif ? Ã©motion ?)",
          "Se priver toute la journÃ©e",
          "Manger debout rapidement",
          "Boire uniquement du cafÃ©"
        ],
        correctIndex: 0
      },
      {
        id: 5,
        question: "Quel environnement favorise le grignotage ?",
        options: [
          "Snacks visibles Ã  cÃ´tÃ© de soi",
          "Fruits sur la table",
          "Placards rangÃ©s",
          "Eau Ã  portÃ©e de main"
        ],
        correctIndex: 0
      }
    ];

    const quizForm = document.getElementById("quiz-form");
    const quizProgress = document.getElementById("quiz-progress");
    const quizResult = document.getElementById("quiz-result");
    const quizFeedback = document.getElementById("quiz-feedback");
    const submitBtn = document.getElementById("quiz-submit");
    const resetBtn = document.getElementById("quiz-reset");

    function renderQuiz() {
      quizForm.innerHTML = "";
      quizData.forEach((q, index) => {
        const container = document.createElement("div");
        container.className = "quiz-question";
        container.dataset.questionId = q.id;

        container.innerHTML = `
          <div class="quiz-question-header">
            <div class="quiz-question-label">Q${index + 1}. ${q.question}</div>
            <div class="quiz-question-meta">1 seule bonne rÃ©ponse</div>
          </div>

          <div class="quiz-options">
            ${q.options.map((opt, i) => `
              <label class="quiz-option">
                <input type="radio" name="question-${q.id}" value="${i}">
                <span>${opt}</span>
              </label>
            `).join("")}
          </div>
        `;
        quizForm.appendChild(container);
      });

      quizProgress.textContent = "Question 1 sur " + quizData.length;
      quizResult.textContent = "RÃ©ponds puis valide pour voir ton score.";
      quizFeedback.textContent = "";
    }

    function updateProgress() {
      const total = quizData.length;
      const answered = quizData.filter(q =>
        [...document.querySelectorAll(`input[name="question-${q.id}"]`)]
          .some(el => el.checked)
      ).length;

      quizProgress.textContent = "Question " + (answered || 1) + " sur " + total;
    }
    quizForm.addEventListener("change", updateProgress);

    function evaluateQuiz() {
      let score = 0;

      document.querySelectorAll(".quiz-option").forEach(opt =>
        opt.classList.remove("correct","incorrect")
      );

      quizData.forEach(q => {
        const radios = document.querySelectorAll(`input[name="question-${q.id}"]`);
        let selected = null;

        radios.forEach((r, i) => { if (r.checked) selected = i; });

        const block = document.querySelector(`.quiz-question[data-question-id="${q.id}"]`);
        const options = block.querySelectorAll(".quiz-option");

        if (selected === q.correctIndex) {
          score++;
          options[selected]?.classList.add("correct");
        } else {
          options[q.correctIndex]?.classList.add("correct");
          if (selected !== null) {
            options[selected]?.classList.add("incorrect");
          }
        }
      });

      const ratio = score / quizData.length;

      let msg =
        ratio === 1 ? "Parfait ! Tu maÃ®trises les bases pour rÃ©duire le grignotage ğŸ" :
        ratio >= 0.7 ? "TrÃ¨s bon score !" :
        ratio >= 0.4 ? "Pas mal, relis certains points." :
        "Relis lâ€™article et retente tranquillement.";

      quizResult.innerHTML = `<strong>${score}/${quizData.length}</strong> bonnes rÃ©ponses â€¢ ${msg}`;

      if (window.acadGamification)
        window.acadGamification.registerQuizResult(ARTICLE_ID, score, quizData.length);

      quizFeedback.textContent =
        ratio === 1 ? "ğŸ® Bravo ! XP bonus ajoutÃ©e." : "Tu peux recommencer pour viser le 100 %.";
    }

    submitBtn.addEventListener("click", evaluateQuiz);
    resetBtn.addEventListener("click", renderQuiz);

    // XP lecture
    const readBtn = document.getElementById("mark-article-read");
    readBtn?.addEventListener("click", () => {
      if (window.acadGamification)
        window.acadGamification.markArticleRead(ARTICLE_ID, 20);

      readBtn.textContent = "âœ“ Article comptÃ© pour lâ€™XP locale";
      readBtn.disabled = true;
    });

    // XP partage
    const shareBtn = document.getElementById("share-article");
    const shareFeedback = document.getElementById("share-feedback");

    shareBtn?.addEventListener("click", async () => {
      if (window.acadGamification)
        window.acadGamification.registerShare(ARTICLE_ID, 15);

      const shareData = {
        title: "A-CadÃ©mie â€” Comment arrÃªter le grignotage",
        text: "DÃ©couvre comment rÃ©duire le grignotage + quiz express.",
        url: window.location.href
      };

      if (navigator.share) {
        try {
          await navigator.share(shareData);
          shareFeedback.textContent = "Merci pour le partage ! (XP ajoutÃ©e)";
        } catch {
          shareFeedback.textContent = "Partage annulÃ© ğŸ˜‰";
        }
      } else {
        shareFeedback.textContent =
          "Ton navigateur ne supporte pas le partage automatique, mais tu peux copier le lien. (XP ajoutÃ©e)";
      }
    });

    renderQuiz();
  </script>

</body>
</html>
